<div class="property-detail" *ngIf="property">
  <div class="back-nav">
    <button class="btn btn-secondary" (click)="goBack()">‚Üê Retour aux propri√©t√©s</button>
  </div>

  <div class="property-header">
    <h1>{{ property.title }}</h1>
    <p class="location">üìç {{ property.location }}</p>
  </div>

  <div class="property-content">
    <!-- Image de la propri√©t√© -->
    <div class="property-images">
      <img [src]="getPropertyImage(property.id)" [alt]="property.title" class="main-image">
    </div>

    <div class="property-info">
      <!-- Description -->
      <div class="description-section">
        <h3>Description</h3>
        <p>{{ property.description || 'Aucune description disponible' }}</p>
      </div>

      <!-- D√©tails de la propri√©t√© -->
      <div class="details-section">
        <h3>D√©tails</h3>
        <div class="detail-item">
          <span class="label">Prix par jour:</span>
          <span class="value">{{ property.pricePerDay }} ETH</span>
        </div>
        <div class="detail-item">
          <span class="label">D√©p√¥t de garantie:</span>
          <span class="value">{{ property.deposit }} ETH</span>
        </div>
        <div class="detail-item">
          <span class="label">Propri√©taire:</span>
          <span class="value">{{ formatAddress(property.owner) }}</span>
        </div>
        <div class="detail-item">
          <span class="label">Statut:</span>
          <span class="value" [class.available]="property.isAvailable" 
                [class.unavailable]="!property.isAvailable">
            {{ property.isAvailable ? '‚úÖ Disponible' : '‚ùå Occup√©e' }}
          </span>
        </div>
      </div>

      <!-- Formulaire de location -->
      <div class="rental-form" *ngIf="property.isAvailable && isConnected">
        <h3>üìÖ R√©server cette propri√©t√©</h3>
        
        <form (ngSubmit)="onRentSubmit()" #rentalForm="ngForm">
          <div class="form-group">
            <label for="startDate">Date d'arriv√©e *</label>
            <input type="date" id="startDate" 
                   [(ngModel)]="rentalData.startDate" 
                   name="startDate" 
                   required 
                   [min]="getMinStartDate()"
                   (change)="calculateTotal()"
                   class="form-control">
            <small>√Ä partir de demain</small>
          </div>

          <div class="form-group">
            <label for="endDate">Date de d√©part *</label>
            <input type="date" id="endDate" 
                   [(ngModel)]="rentalData.endDate" 
                   name="endDate" 
                   required 
                   [min]="getMinEndDate()"
                   (change)="calculateTotal()"
                   class="form-control">
            <small>Au moins 1 nuit</small>
          </div>

          <!-- Calcul du prix -->
          <div class="price-calculation" *ngIf="rentalData.totalPrice > 0">
            <h4>üí∞ D√©tail du prix</h4>
            <div class="calculation-item">
              <span>Prix du s√©jour ({{ calculateDays() }} jours):</span>
              <span>{{ rentalData.totalPrice }} ETH</span>
            </div>
            <div class="calculation-item">
              <span>D√©p√¥t de garantie:</span>
              <span>{{ property.deposit }} ETH</span>
            </div>
            <div class="calculation-item total">
              <span><strong>Montant total √† payer:</strong></span>
              <span><strong>{{ rentalData.totalPrice + property.deposit }} ETH</strong></span>
            </div>
          </div>

          <!-- Message d'erreur -->
          <div *ngIf="error" class="error-message">
            ‚ùå {{ error }}
          </div>

          <button type="submit" 
                  class="btn btn-primary rent-btn" 
                  [disabled]="!canRent() || processing">
            {{ processing ? '‚è≥ Traitement...' : '‚úÖ Confirmer la location' }}
          </button>
        </form>
      </div>

      <!-- Message si non connect√© -->
      <div *ngIf="!isConnected" class="connect-warning">
        <h4>üîó Connexion requise</h4>
        <p>Veuillez connecter votre wallet MetaMask pour louer cette propri√©t√©</p>
      </div>

      <!-- Message si propri√©t√© occup√©e -->
      <div *ngIf="!property.isAvailable" class="unavailable-warning">
        <h4>‚ùå Non disponible</h4>
        <p>Cette propri√©t√© est actuellement occup√©e</p>
      </div>
    </div>
  </div>
</div>

<!-- Loading state -->
<div *ngIf="loading" class="loading">
  <p>Chargement de la propri√©t√©...</p>
</div>

<!-- Error state -->
<div *ngIf="!property && !loading" class="not-found">
  <h3>Propri√©t√© non trouv√©e</h3>
  <button class="btn btn-secondary" (click)="goBack()">Retour aux propri√©t√©s</button>
</div>